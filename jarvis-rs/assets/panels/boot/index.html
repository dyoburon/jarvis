<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JARVIS Boot</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #1F2430;
    --accent: #FFCC66;
    --text: #CCCAC2;
    --muted: #707A8C;
    --border: #171B24;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'SF Mono', 'Fira Code', 'JetBrains Mono', 'Cascadia Code', monospace;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* ── Horizontal scan line — slow ── */
  .scan-h {
    position: fixed;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent 10%, var(--accent) 50%, transparent 90%);
    opacity: 0.25;
    animation: scanH 12s linear infinite;
    z-index: 10;
  }
  @keyframes scanH {
    0%   { transform: translateY(-2px); }
    100% { transform: translateY(100vh); }
  }

  /* ── Vertical scan line — slow ── */
  .scan-v {
    position: fixed;
    top: 0; bottom: 0; left: 0;
    width: 1px;
    background: linear-gradient(180deg, transparent 10%, var(--accent) 50%, transparent 90%);
    opacity: 0.18;
    animation: scanV 16s linear infinite;
    z-index: 10;
  }
  @keyframes scanV {
    0%   { transform: translateX(-2px); }
    100% { transform: translateX(100vw); }
  }

  /* ── Corner brackets ── */
  .corner { position: fixed; width: 40px; height: 40px; z-index: 10; }
  .corner::before, .corner::after {
    content: ''; position: absolute;
    background: var(--accent); opacity: 0.5;
  }
  .tl { top: 24px; left: 24px; }
  .tl::before { top: 0; left: 0; width: 20px; height: 2px; }
  .tl::after  { top: 0; left: 0; width: 2px; height: 20px; }
  .tr { top: 24px; right: 24px; }
  .tr::before { top: 0; right: 0; width: 20px; height: 2px; }
  .tr::after  { top: 0; right: 0; width: 2px; height: 20px; }
  .bl { bottom: 24px; left: 24px; }
  .bl::before { bottom: 0; left: 0; width: 20px; height: 2px; }
  .bl::after  { bottom: 0; left: 0; width: 2px; height: 20px; }
  .br { bottom: 24px; right: 24px; }
  .br::before { bottom: 0; right: 0; width: 20px; height: 2px; }
  .br::after  { bottom: 0; right: 0; width: 2px; height: 20px; }

  /* ── Vignette ── */
  .vignette {
    position: fixed; inset: 0; z-index: 5;
    background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.5) 100%);
    pointer-events: none;
  }

  /* ── Content ── */
  .boot-content {
    text-align: center;
    z-index: 20;
    position: relative;
  }

  .title {
    font-size: clamp(24px, 4vw, 48px);
    font-weight: 300;
    letter-spacing: 0.5em;
    color: var(--accent);
    margin-bottom: 48px;
    text-shadow: 0 0 20px rgba(255,204,102,0.3);
  }

  .status {
    font-size: clamp(10px, 1.4vw, 14px);
    color: var(--muted);
    letter-spacing: 0.2em;
    height: 20px;
    margin-bottom: 24px;
  }

  .progress-container {
    width: clamp(200px, 35vw, 500px);
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .progress-track {
    flex: 1; height: 3px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%; width: 0%;
    background: var(--accent);
    border-radius: 2px;
    box-shadow: 0 0 8px rgba(255,204,102,0.4);
    transition: width 0.1s linear;
  }
  .progress-pct {
    font-size: 11px;
    color: var(--muted);
    min-width: 32px;
    text-align: right;
    font-variant-numeric: tabular-nums;
  }

  /* ── Asteroids canvas ── */
  canvas#field {
    position: fixed; inset: 0; z-index: 1;
    pointer-events: none;
  }
</style>
</head>
<body>

<canvas id="field"></canvas>
<div class="scan-h"></div>
<div class="scan-v"></div>
<div class="vignette"></div>
<div class="corner tl"></div>
<div class="corner tr"></div>
<div class="corner bl"></div>
<div class="corner br"></div>

<div class="boot-content">
  <div class="title">J A R V I S</div>
  <div class="status" id="status">PROVISIONING ARMAMENTS</div>
  <div class="progress-container">
    <div class="progress-track">
      <div class="progress-fill" id="fill"></div>
    </div>
    <div class="progress-pct" id="pct">0%</div>
  </div>
</div>

<script>
(function() {
  var DURATION = 4500;
  var MSG_INTERVAL = 1500;
  var MESSAGES = [
    'PROVISIONING ARMAMENTS',
    'CALIBRATING SENSOR ARRAY',
    'ESTABLISHING SECURE CHANNELS',
    'INITIALIZING NEURAL INTERFACE',
    'DEPLOYING COUNTERMEASURES',
    'SYNCHRONIZING THREAT MATRIX',
    'LOADING TACTICAL OVERLAYS',
    'VERIFYING BIOMETRIC CLEARANCE',
    'ACTIVATING PERIMETER DEFENSE',
    'COMPILING INTELLIGENCE BRIEFS',
    'SCANNING FREQUENCY SPECTRUM',
    'ENGAGING QUANTUM ENCRYPTION',
    'BOOTSTRAPPING CORE SYSTEMS',
    'SYSTEM ONLINE'
  ];

  var fill = document.getElementById('fill');
  var pctEl = document.getElementById('pct');
  var statusEl = document.getElementById('status');
  var start = performance.now();
  var msgIndex = 0;
  var lastMsg = 0;

  function tick() {
    var elapsed = performance.now() - start;
    var progress = Math.min(elapsed / DURATION, 1);
    var percent = Math.floor(progress * 100);
    fill.style.width = percent + '%';
    pctEl.textContent = percent + '%';
    if (elapsed - lastMsg >= MSG_INTERVAL && msgIndex < MESSAGES.length - 1) {
      msgIndex++;
      statusEl.textContent = MESSAGES[msgIndex];
      lastMsg = elapsed;
    }
    if (progress < 1) {
      requestAnimationFrame(tick);
    } else {
      statusEl.textContent = 'SYSTEM ONLINE';
      if (window.jarvis && window.jarvis.ipc) {
        window.jarvis.ipc.send('boot_complete');
      }
    }
  }
  requestAnimationFrame(tick);

  // ── Asteroids starfield + drifting rocks ──
  var canvas = document.getElementById('field');
  var ctx = canvas.getContext('2d');
  var W, H;

  function resize() {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  // Stars — tiny dots drifting slowly
  var stars = [];
  for (var i = 0; i < 120; i++) {
    stars.push({
      x: Math.random() * 2000,
      y: Math.random() * 2000,
      s: Math.random() * 1.2 + 0.3,
      a: Math.random() * 0.4 + 0.1,
      vx: (Math.random() - 0.5) * 0.15,
      vy: (Math.random() - 0.5) * 0.15
    });
  }

  // Asteroids — irregular polygon outlines drifting & rotating
  var asteroids = [];
  for (var i = 0; i < 12; i++) {
    var pts = [];
    var numPts = Math.floor(Math.random() * 4) + 5;
    for (var j = 0; j < numPts; j++) {
      var angle = (j / numPts) * Math.PI * 2;
      var radius = 8 + Math.random() * 18;
      pts.push({ angle: angle, r: radius });
    }
    asteroids.push({
      x: Math.random() * 2000,
      y: Math.random() * 2000,
      vx: (Math.random() - 0.5) * 0.3,
      vy: (Math.random() - 0.5) * 0.3,
      rot: Math.random() * Math.PI * 2,
      vr: (Math.random() - 0.5) * 0.004,
      pts: pts,
      a: Math.random() * 0.12 + 0.04
    });
  }

  // Footprint trail buffer — stores recent positions for each asteroid
  var TRAIL_LEN = 12;
  for (var i = 0; i < asteroids.length; i++) {
    asteroids[i].trail = [];
  }

  function drawField() {
    ctx.clearRect(0, 0, W, H);

    // Stars
    for (var i = 0; i < stars.length; i++) {
      var s = stars[i];
      s.x += s.vx; s.y += s.vy;
      if (s.x < 0) s.x += W; if (s.x > W) s.x -= W;
      if (s.y < 0) s.y += H; if (s.y > H) s.y -= H;
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.s, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(255,204,102,' + s.a + ')';
      ctx.fill();
    }

    // Asteroids — wireframe outlines with fading footprints
    for (var i = 0; i < asteroids.length; i++) {
      var a = asteroids[i];
      a.x += a.vx; a.y += a.vy; a.rot += a.vr;
      if (a.x < -40) a.x += W + 80;
      if (a.x > W + 40) a.x -= W + 80;
      if (a.y < -40) a.y += H + 80;
      if (a.y > H + 40) a.y -= H + 80;

      // Record footprint every 4th frame to space them out
      a._fc = (a._fc || 0) + 1;
      if (a._fc % 4 === 0) {
        a.trail.push({ x: a.x, y: a.y, rot: a.rot });
        if (a.trail.length > TRAIL_LEN) a.trail.shift();
      }

      // Draw footprints — fading ghostly outlines
      for (var t = 0; t < a.trail.length; t++) {
        var ghost = a.trail[t];
        var fade = ((t + 1) / a.trail.length) * a.a * 0.3;
        ctx.beginPath();
        for (var j = 0; j < a.pts.length; j++) {
          var p = a.pts[j];
          var gx = ghost.x + Math.cos(p.angle + ghost.rot) * p.r;
          var gy = ghost.y + Math.sin(p.angle + ghost.rot) * p.r;
          if (j === 0) ctx.moveTo(gx, gy);
          else ctx.lineTo(gx, gy);
        }
        ctx.closePath();
        ctx.strokeStyle = 'rgba(255,204,102,' + fade + ')';
        ctx.lineWidth = 0.4;
        ctx.stroke();
      }

      // Draw current asteroid
      ctx.beginPath();
      for (var j = 0; j < a.pts.length; j++) {
        var p = a.pts[j];
        var px = a.x + Math.cos(p.angle + a.rot) * p.r;
        var py = a.y + Math.sin(p.angle + a.rot) * p.r;
        if (j === 0) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
      }
      ctx.closePath();
      ctx.strokeStyle = 'rgba(255,204,102,' + a.a + ')';
      ctx.lineWidth = 0.8;
      ctx.stroke();
    }

    requestAnimationFrame(drawField);
  }
  drawField();

  // Skip on keypress
  document.addEventListener('keydown', function() {
    fill.style.width = '100%';
    pctEl.textContent = '100%';
    statusEl.textContent = 'SYSTEM ONLINE';
    if (window.jarvis && window.jarvis.ipc) {
      window.jarvis.ipc.send('boot_complete');
    }
  }, { once: true });
})();
</script>
</body>
</html>
